var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.WithTheme=WithTheme;exports.useTheme=exports.ThemeProvider=exports.ThemeContext=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _react=_interopRequireDefault(require("react"));var _shallowequal=_interopRequireDefault(require("shallowequal"));var _default=_interopRequireDefault(require("./themes/default"));var ThemeContext=_react["default"].createContext(_default["default"]);exports.ThemeContext=ThemeContext;var ThemeProvider=function ThemeProvider(props){var value=props.value,children=props.children;var theme=_react["default"].useMemo(function(){return(0,_extends2["default"])((0,_extends2["default"])({},_default["default"]),value);},[value]);return _react["default"].createElement(ThemeContext.Provider,{value:theme},children);};exports.ThemeProvider=ThemeProvider;var useTheme=function useTheme(){var props=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var theme=_react["default"].useContext(ThemeContext);return(0,_extends2["default"])((0,_extends2["default"])({},theme),props.theme);};exports.useTheme=useTheme;function WithTheme(props){var children=props.children,themeStyles=props.themeStyles,styles=props.styles;var stylesRef=_react["default"].useRef(undefined);var themeRef=_react["default"].useRef(undefined);var cache=_react["default"].useRef(undefined);var getStyles=_react["default"].useCallback(function(theme){var updateCache=false;if(themeStyles){var newStyle=themeStyles(theme);if(themeRef.current===undefined||!(0,_shallowequal["default"])(themeRef.current,newStyle)){themeRef.current=newStyle;updateCache=true;}}if(styles){if(stylesRef.current===undefined||!(0,_shallowequal["default"])(stylesRef.current,styles)){stylesRef.current=styles;updateCache=true;}}if(cache.current===undefined||updateCache){cache.current=(0,_extends2["default"])({},themeRef.current);if(stylesRef.current){Object.keys(stylesRef.current).forEach(function(key){if(cache.current[key]){cache.current[key]=[cache.current[key],stylesRef.current[key]];}});}}return cache.current||{};},[themeStyles,styles]);return _react["default"].createElement(ThemeContext.Consumer,null,function(theme){return children(getStyles(theme),theme);});}